# ═══════════════════════════════════════════════════════════════════════════
# vAvA_core - Recipe txAdmin
# Framework FiveM modulaire, sécurisé et multilingue
# Version: 1.0.0
# ═══════════════════════════════════════════════════════════════════════════

$engine: 3
$onesync: on

name: vAvA_core Framework
version: 1.0.0
author: vAvA
description: |
    Framework FiveM modulaire, sécurisé et multilingue.
    
    Caractéristiques:
    - Système de personnages multi-personnage
    - Économie complète (cash, banque, argent sale)
    - Système de jobs
    - Inventaire
    - Véhicules avec garage
    - Système de logs et sécurité
    - Support multilingue (FR, EN, ES)
    
    Prérequis:
    - Serveur MySQL/MariaDB
    - oxmysql

tasks:
    # ═══════════════════════════════════════════════════════════════════════
    # Téléchargement des fichiers serveur CFX
    # ═══════════════════════════════════════════════════════════════════════
    - action: download_github
      dest: ./resources/[cfx-default]
      ref: master
      src: https://github.com/citizenfx/cfx-server-data
      subpath: resources

    # ═══════════════════════════════════════════════════════════════════════
    # Téléchargement de oxmysql (dépendance requise)
    # ═══════════════════════════════════════════════════════════════════════
    - action: download_file
      path: ./tmp/oxmysql.zip
      url: https://github.com/overextended/oxmysql/releases/download/v2.12.0/oxmysql.zip

    - action: unzip
      dest: ./resources/[standalone]
      src: ./tmp/oxmysql.zip

    - action: remove_path
      path: ./tmp

    # ═══════════════════════════════════════════════════════════════════════
    # Téléchargement de vAvA_core depuis GitHub
    # ═══════════════════════════════════════════════════════════════════════
    - action: download_github
      dest: ./resources/[vava]/vAvA_core
      ref: main
      src: https://github.com/Nicolasbriet/vAvA_core

    # ═══════════════════════════════════════════════════════════════════════
    # Configuration du serveur
    # ═══════════════════════════════════════════════════════════════════════
    - action: move_path
      src: ./resources/[vava]/vAvA_core/server.cfg
      dest: ./server.cfg

    # ═══════════════════════════════════════════════════════════════════════
    # Fin de l'installation
    # ═══════════════════════════════════════════════════════════════════════
    - action: waste_time
      seconds: 1

    - action: connect_database

    - action: query_database
      file: ./resources/[vava]/vAvA_core/database/sql/init.sql
